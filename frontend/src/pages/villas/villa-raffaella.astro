---
// ==============================================================================
// PAGE : VILLA RAFFAELLA (V8 - RESPONSIVE GALLERY SCROLL MOBILE)
// ==============================================================================
import Layout from '../../layouts/Layout.astro';
---

<Layout title="Villa Raffaella | Maison des Sables">
	
	<nav id="navbar" class="fixed top-0 w-full z-50 px-6 md:px-12 py-8 flex justify-between items-center pointer-events-none">
		<a href="/#villas" class="pointer-events-auto group flex items-center gap-4 bg-charbon/10 backdrop-blur-xl px-6 py-3 rounded-full text-white border border-white/10 hover:bg-white hover:text-charbon transition-all duration-700">
			<span class="text-lg transition-transform group-hover:-translate-x-1">‚Üê</span>
			<span class="text-[10px] uppercase tracking-[0.2em] font-bold">Retour Collection</span>
		</a>
	</nav>

	<header class="relative h-screen bg-charbon overflow-hidden">
		<div class="absolute inset-0 z-0 scale-105 animate-slow-zoom">
			<img src="/maison1.png" alt="Villa Raffaella" class="w-full h-full object-cover object-center opacity-90" />
			<div class="absolute inset-0 bg-gradient-to-b from-charbon/40 via-transparent to-[#F9F7F2]"></div>
		</div>
		<div class="relative z-10 h-full flex flex-col justify-end pb-20 px-6 md:px-20 max-w-7xl mx-auto w-full">
			<span class="text-or text-xs font-sans tracking-[0.4em] uppercase block mb-6 font-bold reveal-text">Le Moulleau ‚Ä¢ Arcachon</span>
			<h1 class="font-serif text-7xl md:text-[12rem] text-charbon leading-[0.8] mb-4 reveal-text">Villa <span class="italic text-or font-light">Raffaella.</span></h1>
		</div>
	</header>

	<section class="bg-[#F9F7F2] py-32 px-6 md:px-12 text-charbon">
		<div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-16 items-start">
			<div class="lg:col-span-7 reveal-text">
				<h2 class="font-serif text-4xl md:text-5xl mb-12 leading-tight italic">Une demeure historique, r√©invent√©e pour l'exceptionnel.</h2>
				<p class="font-sans text-xl text-charbon/70 leading-relaxed font-light mb-8">Nich√©e au c≈ìur du quartier tr√®s pris√© du Moulleau, la Villa Raffaella est une c√©l√©bration de l'architecture baln√©aire. Ses volumes g√©n√©reux et sa lumi√®re traversante offrent un cadre de vie idyllique.</p>
				<p class="font-sans text-xl text-charbon/70 leading-relaxed font-light">Le jardin, v√©ritable √©crin de verdure, entoure une piscine chauff√©e aux eaux turquoise, promettant de longs apr√®s-midi de qui√©tude sous le soleil du Bassin.</p>
			</div>

			<div class="lg:col-span-5 lg:pl-12">
				<div class="bg-white p-10 rounded-[3rem] shadow-xl border border-charbon/5 space-y-8 reveal-text">
					<div class="grid grid-cols-2 gap-6 pb-8 border-b border-charbon/5">
						<div><span class="block text-[9px] uppercase tracking-widest text-stone-400 font-bold mb-1">Capacit√©</span><span class="font-serif text-xl">8 Voyageurs</span></div>
						<div><span class="block text-[9px] uppercase tracking-widest text-stone-400 font-bold mb-1">Configuration</span><span class="font-serif text-xl">4 Suites</span></div>
						<div><span class="block text-[9px] uppercase tracking-widest text-stone-400 font-bold mb-1">Espace</span><span class="font-serif text-xl">220 m¬≤</span></div>
						<div><span class="block text-[9px] uppercase tracking-widest text-stone-400 font-bold mb-1">Plage</span><span class="font-serif text-xl">150 m</span></div>
					</div>
					<ul class="space-y-4">
						<li class="flex items-center gap-3 text-xs uppercase tracking-widest font-bold text-stone-500"><span class="text-or">‚úì</span> Piscine Chauff√©e</li>
						<li class="flex items-center gap-3 text-xs uppercase tracking-widest font-bold text-stone-500"><span class="text-or">‚úì</span> Conciergerie Incluse</li>
						<li class="flex items-center gap-3 text-xs uppercase tracking-widest font-bold text-stone-500"><span class="text-or">‚úì</span> V√©los √† disposition</li>
					</ul>
				</div>
			</div>
		</div>
	</section>

    <section class="bg-white py-12 px-0 md:px-6 overflow-hidden">
        <div class="md:hidden text-center mb-6 text-[10px] uppercase tracking-[0.2em] text-charbon/40 animate-pulse">
            ‚Üê Glisser pour visiter ‚Üí
        </div>

		<div class="flex overflow-x-auto snap-x snap-mandatory gap-4 px-6 no-scrollbar md:grid md:grid-cols-12 md:gap-6 md:h-[120vh] md:max-w-[1800px] md:mx-auto md:overflow-visible">
			
            <div class="min-w-[85vw] md:min-w-0 snap-center md:col-span-8 h-[60vh] md:h-full overflow-hidden rounded-[2.5rem] md:rounded-[3rem] group relative shadow-lg">
				<img src="/card_salon.png" class="w-full h-full object-cover transition-transform duration-[2s] group-hover:scale-110" alt="Salon Design"/>
				<div class="absolute inset-0 bg-charbon/20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
					<span class="text-white border border-white/50 px-8 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold backdrop-blur-sm">Le Salon</span>
				</div>
			</div>

            <div class="min-w-[85vw] md:min-w-0 snap-center md:col-span-4 h-[60vh] md:h-full overflow-hidden rounded-[2.5rem] md:rounded-[3rem] group relative shadow-lg">
                <img src="/card_cuisine.png" class="w-full h-full object-cover transition-transform duration-[2s] group-hover:scale-110" alt="Cuisine"/>
                <div class="absolute inset-0 bg-charbon/20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                    <span class="text-white border border-white/50 px-8 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold backdrop-blur-sm">Cuisine √âquip√©e</span>
                </div>
            </div>

            <div class="min-w-[85vw] md:min-w-0 snap-center md:col-span-4 md:hidden h-[60vh] overflow-hidden rounded-[2.5rem] group relative shadow-lg">
                <img src="/card_suite.png" class="w-full h-full object-cover" alt="Suite Parentale"/>
            </div>

            <div class="hidden md:block md:col-span-4 overflow-hidden rounded-[3rem] group relative">
				<img src="/card_suite.png" class="w-full h-full object-cover transition-transform duration-[2s] group-hover:scale-110" alt="Suite Parentale"/>
				<div class="absolute inset-0 bg-charbon/20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
					<span class="text-white border border-white/50 px-8 py-3 rounded-full text-[10px] uppercase tracking-widest font-bold backdrop-blur-sm">Master Suite</span>
				</div>
			</div>
		</div>
	</section>

	<section id="contact-villa" class="bg-white py-32 px-6 md:px-12 border-t border-charbon/5">
		<div class="max-w-4xl mx-auto">
			<div class="text-center mb-16 reveal-text">
				<span class="text-or text-xs font-sans tracking-[0.3em] uppercase mb-4 block font-bold">R√©servation</span>
				<h3 class="font-serif text-4xl md:text-6xl text-charbon">Demander un s√©jour</h3>
			</div>

			<form id="villa-form" class="space-y-12 bg-[#F9F7F2] p-10 md:p-16 rounded-[3rem] reveal-text shadow-sm border border-charbon/5">
				<input type="hidden" name="villa_name" value="Villa Raffaella">
				
				<div class="grid grid-cols-1 md:grid-cols-2 gap-12">
					<div class="group">
						<label class="text-[10px] uppercase tracking-widest text-stone-400 mb-3 block font-bold group-focus-within:text-or transition-colors">Nom Complet</label>
						<input type="text" name="name" class="w-full bg-transparent border-b border-stone-200 py-3 text-charbon outline-none focus:border-or transition-all font-sans text-lg" required placeholder="Jean Dupont"/>
					</div>
					<div class="group">
						<label class="text-[10px] uppercase tracking-widest text-stone-400 mb-3 block font-bold group-focus-within:text-or transition-colors">Dates de s√©jour</label>
						<div class="relative">
							<input type="text" id="date-picker" name="dates" class="w-full bg-transparent border-b border-stone-200 py-3 text-charbon outline-none focus:border-or transition-all font-sans text-lg cursor-pointer" readonly placeholder="S√©lectionnez vos dates..."/>
							<span class="absolute right-0 top-1/2 -translate-y-1/2 text-or">üìÖ</span>
						</div>
					</div>
				</div>

				<div class="grid grid-cols-1 md:grid-cols-2 gap-12">
					<div class="group">
						<label class="text-[10px] uppercase tracking-widest text-stone-400 mb-3 block font-bold group-focus-within:text-or transition-colors">Email</label>
						<input type="email" name="email" class="w-full bg-transparent border-b border-stone-200 py-3 text-charbon outline-none focus:border-or transition-all font-sans text-lg" required placeholder="votre@mail.com"/>
					</div>
					<div class="group">
						<label class="text-[10px] uppercase tracking-widest text-stone-400 mb-3 block font-bold group-focus-within:text-or transition-colors">T√©l√©phone</label>
						<input type="tel" name="phone" class="w-full bg-transparent border-b border-stone-200 py-3 text-charbon outline-none focus:border-or transition-all font-sans text-lg" required placeholder="06 .. .. .. .."/>
					</div>
				</div>

				<div class="group">
					<label class="text-[10px] uppercase tracking-widest text-stone-400 mb-3 block font-bold group-focus-within:text-or transition-colors">Pr√©cisions ou demandes particuli√®res</label>
					<textarea name="message" rows="3" class="w-full bg-transparent border-b border-stone-200 py-3 text-charbon outline-none focus:border-or transition-all resize-none font-sans text-lg" placeholder="Avez-vous besoin de services particuliers ?"></textarea>
				</div>

				<button type="submit" class="w-full group relative py-6 bg-charbon text-sable font-sans text-xs font-bold uppercase tracking-[0.2em] rounded-2xl overflow-hidden shadow-lg transition-all duration-500 hover:-translate-y-1">
					<span class="relative z-10 group-hover:text-white transition-colors">Envoyer ma demande</span>
					<div class="absolute inset-0 bg-or translate-y-full group-hover:translate-y-0 transition-transform duration-500 ease-out z-0"></div>
				</button>
			</form>
		</div>
	</section>

	<div id="toast-success" class="fixed bottom-10 left-1/2 -translate-x-1/2 z-[100] bg-charbon border border-or/50 text-white px-8 py-4 rounded-full shadow-2xl opacity-0 translate-y-10 transition-all duration-500 pointer-events-none">
		<div class="flex items-center gap-3">
			<span class="text-or font-bold">‚úì</span>
			<span class="font-sans text-xs uppercase tracking-[0.2em] font-medium">Demande envoy√©e avec succ√®s</span>
		</div>
	</div>

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

</Layout>

<style is:global>
	/* --- STYLISATION DU CALENDRIER (FLATPICKR) --- */
	.flatpickr-calendar {
		background: #1C1C1C !important; /* Charbon */
		border-radius: 2rem !important;
		border: 1px solid rgba(212, 175, 55, 0.2) !important;
		box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5) !important;
		font-family: 'Inter', sans-serif !important;
		animation: calendarFadeIn 0.4s ease-out;
	}

	@keyframes calendarFadeIn {
		from { opacity: 0; transform: translateY(10px) scale(0.98); }
		to { opacity: 1; transform: translateY(0) scale(1); }
	}

	.flatpickr-day.selected, .flatpickr-day.startRange, .flatpickr-day.endRange {
		background: #D4AF37 !important;
		border-color: #D4AF37 !important;
		color: #1C1C1C !important;
		font-weight: bold !important;
	}

	.flatpickr-day.inRange {
		background: rgba(212, 175, 55, 0.1) !important;
		box-shadow: none !important;
		color: #D4AF37 !important;
	}

	.flatpickr-months .flatpickr-month, .flatpickr-weekday {
		color: #F9F7F2 !important;
		fill: #F9F7F2 !important;
		text-transform: uppercase;
		font-size: 10px;
		letter-spacing: 0.1em;
	}

	.flatpickr-day {
		color: rgba(249, 247, 242, 0.6) !important;
		border-radius: 8px !important;
	}

	/* --- ANIMATIONS PAGE --- */
	@keyframes slowZoom { from { transform: scale(1); } to { transform: scale(1.1); } }
	.animate-slow-zoom { animation: slowZoom 30s infinite alternate ease-in-out; }
	.reveal-text { opacity: 0; transform: translateY(30px); }

    /* GESTION SCROLL MOBILE */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
</style>

<script>
	import { gsap } from "gsap";
	import { ScrollTrigger } from "gsap/ScrollTrigger";
	import flatpickr from "flatpickr";
	import { French } from "flatpickr/dist/l10n/fr.js";

	gsap.registerPlugin(ScrollTrigger);

	window.addEventListener('load', () => {
		const reveals = document.querySelectorAll('.reveal-text');
		reveals.forEach(el => {
			gsap.to(el, { opacity: 1, y: 0, duration: 1.5, ease: "power3.out", scrollTrigger: { trigger: el, start: "top 90%" } });
		});

		flatpickr("#date-picker", {
			locale: French,
			mode: "range",
			minDate: "today",
			dateFormat: "d/m/Y",
			disableMobile: "true",
		});

		const form = document.getElementById('villa-form') as HTMLFormElement;
		const toast = document.getElementById('toast-success');

		if (form && toast) {
			form.addEventListener('submit', async (e) => {
				e.preventDefault(); 
				const formData = new FormData(form);
				const data: any = Object.fromEntries(formData);
				data.service_name = `Location Villa : ${data.villa_name}`;
				delete data.villa_name;
				
				try {
					const response = await fetch('https://maison-des-sables.fr/api/contact/lead', { 
						method: 'POST', 
						headers: { 'Content-Type': 'application/json' }, 
						body: JSON.stringify(data) 
					});
					if (response.ok) { 
						toast.classList.remove('opacity-0', 'translate-y-10');
						toast.classList.add('opacity-100', 'translate-y-0');
						form.reset(); 
						setTimeout(() => {
							toast.classList.add('opacity-0', 'translate-y-10');
							toast.classList.remove('opacity-100', 'translate-y-0');
						}, 4000);
					} 
				} catch (error) { console.error("Erreur d'envoi", error); }
			});
		}
	});
</script>